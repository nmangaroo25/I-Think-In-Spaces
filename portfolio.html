<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Norris Mangaroo — Portfolio Flipbook</title>
<style>
  :root{
    --bg:#0f1720;
    --card:#fff;
    --muted:#8892a6;
  }
  html, body {
    height:100%;
    margin:0;
    font-family:Inter,Helvetica,Arial,sans-serif;
    background:var(--bg);
    color:#fff;
  }
  a.back {
    position:fixed;
    left:18px;
    top:18px;
    background:#fff;
    color:#111;
    padding:8px 12px;
    border-radius:8px;
    text-decoration:none;
    font-weight:600;
    z-index:9999;
  }
  .topbar {
    position:fixed;
    right:18px;
    top:18px;
    display:flex;
    gap:8px;
    align-items:center;
    z-index:9999;
  }
  .btn {
    background:#fff;
    color:#111;
    border:none;
    padding:8px 10px;
    border-radius:8px;
    font-weight:600;
    cursor:pointer;
  }
  .pager {
    display:flex;
    gap:6px;
    align-items:center;
    background:rgba(255,255,255,0.04);
    padding:6px 8px;
    border-radius:8px;
  }
  #flipbook-wrap {
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:auto;
  }
  #flipbook {
    background:transparent;
    transform-origin: top center;
  }
  .page {
    background:var(--card);
    display:inline-block;
    vertical-align:top;
  }
  #message {
    position:fixed;
    left:18px;
    bottom:18px;
    background:rgba(255,255,255,0.06);
    padding:8px 12px;
    border-radius:8px;
    color:var(--muted);
    font-size:13px;
    max-width:45%;
  }
</style>
</head>
<body>
<a class="back" href="https://nmangaroo25.github.io/I-Think-In-Spaces/#home">← Back to Home</a>

<div class="topbar" role="toolbar" aria-label="Flipbook controls">
  <div class="pager" title="Navigation">
    <button id="prev" class="btn">‹</button>
    <input id="pageNum" type="number" min="1" value="1" style="width:64px;padding:6px;border-radius:6px;border:none;font-weight:700">
    <span id="pageTotal" style="color:var(--muted);font-weight:600;padding-left:6px">/ 0</span>
    <button id="next" class="btn">›</button>
  </div>
  <div style="width:10px"></div>
  <div class="pager" title="View">
    <button id="zoomOut" class="btn">−</button>
    <button id="zoomIn" class="btn">＋</button>
  </div>
</div>

<div id="flipbook-wrap">
  <div id="flipbook" aria-live="polite"></div>
</div>

<div id="message">Loading flipbook…</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/0.11/turn.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script>
pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";

(async function(){
  const url = "Norris_Mangaroo_Arch_Portfolio.pdf";
  const flipbookEl = $('#flipbook');
  let currentZoom = 1;

  try {
    const pdf = await pdfjsLib.getDocument(url).promise;
    const totalPages = pdf.numPages;
    $('#pageTotal').text('/ '+totalPages);

    const maxPageWidth = 800;

    for(let i=1; i<=totalPages; i++){
      const page = await pdf.getPage(i);
      const viewport = page.getViewport({scale:1});
      const scale = maxPageWidth / viewport.width;
      const scaledViewport = page.getViewport({scale: scale});

      const canvas = document.createElement('canvas');
      canvas.width = scaledViewport.width;
      canvas.height = scaledViewport.height;
      await page.render({canvasContext:canvas.getContext('2d'), viewport: scaledViewport}).promise;

      const pageDiv = document.createElement('div');
      pageDiv.className = 'page';
      pageDiv.style.width = canvas.width+'px';
      pageDiv.style.height = canvas.height+'px';
      pageDiv.appendChild(canvas);
      flipbookEl.append(pageDiv);
    }

    const firstPage = flipbookEl.find('.page')[0];

    // Responsive display: single page on small screens
    const displayMode = window.innerWidth < 768 ? 'single' : 'double';

    flipbookEl.turn({
      width:firstPage.scrollWidth * (displayMode==='double'?2:1),
      height:firstPage.scrollHeight,
      display: displayMode,
      autoCenter: true,
      elevation: 50,
      duration: 400
    });

    // Navigation
    $('#prev').click(()=>flipbookEl.turn('previous'));
    $('#next').click(()=>flipbookEl.turn('next'));
    $('#pageNum').attr('max', flipbookEl.turn('pages'));
    $('#pageNum').on('change', function(){
      const p = Math.max(1, Math.min(flipbookEl.turn('pages'), Number(this.value)||1));
      flipbookEl.turn('page', p);
    });
    flipbookEl.bind('turned', (e,p)=>$('#pageNum').val(p));

    // Zoom (optional)
    function applyZoom(){ flipbookEl.css('transform', 'scale('+currentZoom+')'); }
    $('#zoomIn').click(()=>{ currentZoom=Math.min(2.5, (currentZoom+0.1).toFixed(2)); applyZoom(); });
    $('#zoomOut').click(()=>{ currentZoom=Math.max(0.5, (currentZoom-0.1).toFixed(2)); applyZoom(); });

    // Fit screen
    function fitScreen(){
      const winW = window.innerWidth*0.95;
      const winH = window.innerHeight*0.85;
      const mode = window.innerWidth < 768 ? 'single' : 'double';
      const pageW = firstPage.scrollWidth * (mode==='double'?2:1);
      currentZoom = Math.min(winW/pageW, winH/firstPage.scrollHeight);
      flipbookEl.turn('display', mode);
      applyZoom();
    }

    $(window).on('resize', fitScreen);
    fitScreen();

    flipbookEl.turn('page',1);
    $('#message').text('Flipbook loaded — enjoy!');

  } catch(e) {
    console.error(e);
    $('#message').text('Error loading PDF');
  }
})();
</script>
</body>
</html>
